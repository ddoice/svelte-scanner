var oo=Object.defineProperty;var so=(e,t,n)=>t in e?oo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var It=(e,t,n)=>(so(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();function P(){}function Qn(e){return e()}function Un(){return Object.create(null)}function he(e){e.forEach(Qn)}function xn(e){return typeof e=="function"}function it(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let xe;function K(e,t){return e===t?!0:(xe||(xe=document.createElement("a")),xe.href=t,e===xe.href)}function io(e){return Object.keys(e).length===0}function co(e,...t){if(e==null){for(const o of t)o(void 0);return P}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function nt(e,t,n){e.$$.on_destroy.push(co(t,n))}function zn(e){return e??""}function s(e,t){e.appendChild(t)}function A(e,t,n){e.insertBefore(t,n||null)}function D(e){e.parentNode&&e.parentNode.removeChild(e)}function eo(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function w(){return h(" ")}function ro(){return h("")}function J(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function f(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function lo(e){return e===""?null:+e}function ao(e){return Array.from(e.childNodes)}function q(e,t){t=""+t,e.data!==t&&(e.data=t)}function Ce(e,t){e.value=t??""}function Hn(e,t,n){for(let o=0;o<e.options.length;o+=1){const i=e.options[o];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function uo(e){const t=e.querySelector(":checked");return t&&t.__value}let Me;function Se(e){Me=e}function fo(){if(!Me)throw new Error("Function called outside component initialization");return Me}function po(e){fo().$$.on_mount.push(e)}const me=[],Nt=[];let ge=[];const Jn=[],mo=Promise.resolve();let kt=!1;function go(){kt||(kt=!0,mo.then(to))}function ot(e){ge.push(e)}const qt=new Set;let de=0;function to(){if(de!==0)return;const e=Me;do{try{for(;de<me.length;){const t=me[de];de++,Se(t),vo(t.$$)}}catch(t){throw me.length=0,de=0,t}for(Se(null),me.length=0,de=0;Nt.length;)Nt.pop()();for(let t=0;t<ge.length;t+=1){const n=ge[t];qt.has(n)||(qt.add(n),n())}ge.length=0}while(me.length);for(;Jn.length;)Jn.pop()();kt=!1,qt.clear(),Se(e)}function vo(e){if(e.fragment!==null){e.update(),he(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ot)}}function ho(e){const t=[],n=[];ge.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),ge=t}const et=new Set;let ne;function _o(){ne={r:0,c:[],p:ne}}function bo(){ne.r||he(ne.c),ne=ne.p}function Fe(e,t){e&&e.i&&(et.delete(e),e.i(t))}function tt(e,t,n,o){if(e&&e.o){if(et.has(e))return;et.add(e),ne.c.push(()=>{et.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function st(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function no(e){e&&e.c()}function Pt(e,t,n){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,n),ot(()=>{const c=e.$$.on_mount.map(Qn).filter(xn);e.$$.on_destroy?e.$$.on_destroy.push(...c):he(c),e.$$.on_mount=[]}),i.forEach(ot)}function Lt(e,t){const n=e.$$;n.fragment!==null&&(ho(n.after_update),he(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function wo(e,t){e.$$.dirty[0]===-1&&(me.push(e),go(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Bt(e,t,n,o,i,c,r=null,d=[-1]){const p=Me;Se(e);const l=e.$$={fragment:null,ctx:[],props:c,update:P,not_equal:i,bound:Un(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(p?p.$$.context:[])),callbacks:Un(),dirty:d,skip_bound:!1,root:t.target||p.$$.root};r&&r(l.root);let C=!1;if(l.ctx=n?n(e,t.props||{},(m,_,...$)=>{const S=$.length?$[0]:_;return l.ctx&&i(l.ctx[m],l.ctx[m]=S)&&(!l.skip_bound&&l.bound[m]&&l.bound[m](S),C&&wo(e,m)),_}):[],l.update(),C=!0,he(l.before_update),l.fragment=o?o(l.ctx):!1,t.target){if(t.hydrate){const m=ao(t.target);l.fragment&&l.fragment.l(m),m.forEach(D)}else l.fragment&&l.fragment.c();t.intro&&Fe(e.$$.fragment),Pt(e,t.target,t.anchor),to()}Se(p)}class jt{constructor(){It(this,"$$");It(this,"$$set")}$destroy(){Lt(this,1),this.$destroy=P}$on(t,n){if(!xn(n))return P;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!io(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const yo="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(yo);const fe=[];function ct(e,t=P){let n;const o=new Set;function i(d){if(it(e,d)&&(e=d,n)){const p=!fe.length;for(const l of o)l[1](),fe.push(l,e);if(p){for(let l=0;l<fe.length;l+=2)fe[l][0](fe[l+1]);fe.length=0}}}function c(d){i(d(e))}function r(d,p=P){const l=[d,p];return o.add(l),o.size===1&&(n=t(i,c)||P),d(e),()=>{o.delete(l),o.size===0&&n&&(n(),n=null)}}return{set:i,update:c,subscribe:r}}let Rn=0;const $o=3e3;function Co(){const{subscribe:e,update:t}=ct([]);function n(i){Rn+=1;const c=Rn,r={...i,id:c};t(d=>[...d,r].slice(-5)),setTimeout(()=>{o(c)},$o)}function o(i){t(c=>c.filter(r=>r.id!==i))}return{subscribe:e,addNotification:n,closeNotification:o}}const ve=Co();function Vn(e,t,n){const o=e.slice();return o[2]=t[n],o}function Zn(e){let t,n,o=e[2].text+"",i,c,r,d,p,l,C;function m(){return e[1](e[2])}return{c(){t=u("div"),n=u("div"),i=h(o),c=w(),r=u("button"),r.textContent="X",d=w(),f(r,"class","svelte-1mipv5u"),f(t,"class",p=zn(`notification ${e[2].type}`)+" svelte-1mipv5u")},m(_,$){A(_,t,$),s(t,n),s(n,i),s(t,c),s(t,r),s(t,d),l||(C=J(r,"click",m),l=!0)},p(_,$){e=_,$&1&&o!==(o=e[2].text+"")&&q(i,o),$&1&&p!==(p=zn(`notification ${e[2].type}`)+" svelte-1mipv5u")&&f(t,"class",p)},d(_){_&&D(t),l=!1,C()}}}function So(e){let t,n=st(e[0]),o=[];for(let i=0;i<n.length;i+=1)o[i]=Zn(Vn(e,n,i));return{c(){t=u("div");for(let i=0;i<o.length;i+=1)o[i].c();f(t,"id","notifications-container"),f(t,"class","svelte-1mipv5u")},m(i,c){A(i,t,c);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(t,null)},p(i,[c]){if(c&1){n=st(i[0]);let r;for(r=0;r<n.length;r+=1){const d=Vn(i,n,r);o[r]?o[r].p(d,c):(o[r]=Zn(d),o[r].c(),o[r].m(t,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},i:P,o:P,d(i){i&&D(t),eo(o,i)}}}function Fo(e,t,n){let o;return nt(e,ve,c=>n(0,o=c)),[o,c=>ve.closeNotification(c.id)]}class Mo extends jt{constructor(t){super(),Bt(this,t,Fo,So,it,{})}}const Do="https://yup.perfdive.com/api",rt=async(e,t)=>{const n=await fetch(`${Do}${e}`,t);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return n},To=async e=>{try{return await rt("/log",{method:"POST",headers:{"Content-Type":"application/json",device:localStorage.getItem("deviceAlias"),event:"trackCapabilities"},body:JSON.stringify(e)})}catch(t){console.error(t),ve.addNotification({text:"sendTrackCapabilities failed, "+t.message,type:"error"})}},Io=async e=>{try{return await rt("/log",{method:"POST",headers:{"Content-Type":"application/json",device:localStorage.getItem("deviceAlias"),event:"trackSettings"},body:JSON.stringify(e)})}catch(t){console.error(t),ve.addNotification({text:"sendTrackSettings failed, "+t.message,type:"error"})}},Et=async(e,t)=>{try{return await rt("/log",{method:"POST",headers:{"Content-Type":"application/json",device:localStorage.getItem("deviceAlias"),event:e},body:JSON.stringify(t)})}catch(n){console.error(n),ve.addNotification({text:`Send ${e} event failed, `+n.message,type:"error"})}},qo=async e=>{const t=new FormData;t.append("photo",e);try{const n=await rt("/upload",{method:"POST",body:t,headers:{device:localStorage.getItem("deviceAlias"),event:"trackSettings"}})}catch(n){console.error(n),ve.addNotification({text:"sendPhoto failed, "+n.message,type:"error"})}},Ao=e=>{const t=e.getCapabilities(),n=e.getSettings();return To(t),Io(n),{capabilities:t,canAutoFocus:()=>t.focusDistance&&t.focusMode&&(t==null?void 0:t.focusMode.includes("manual"))||!1,getFocusDistance:()=>{const{focusDistance:m}=t;return m&&(m.max-m.min)/m.step,m},getSettings:()=>e.getSettings(),setFocusMode:m=>e.applyConstraints({advanced:[{focusMode:m}]}),setFocusDistance:m=>e.applyConstraints({advanced:[{focusMode:"manual",focusDistance:m}]}),setTorch:m=>{t.torch&&e.applyConstraints({advanced:[{torch:m}]})},settings:n,setFocusDistancePct:async m=>{const{focusDistance:_}=t;if(!_){alert("Focus distance not supported");return}const $=(_.max-_.min)/100,S=_.min+$*m;try{await e.applyConstraints({advanced:[{focusMode:"manual",focusDistance:S}]})}catch(g){alert(g.message),console.error(g)}return S},setZoom:m=>e.applyConstraints({advanced:[{zoom:m}]})}},Oo=.1;let pe;const No=({file:e,volume:t})=>{pe==null||pe.pause(),pe=new Audio(`public/sounds/${e}.ogg`),pe.volume=t||Oo,pe.play()};function ko(){const e=["grabFrame","videoCapture"];let t="videoCapture",n=0,o=0,i=0,c=0,r=0,d,p=!1,l=null,C,m,_;function $(b,y,I,R){_=b,C=new ImageCapture(y),m=new BarcodeDetector({formats:["pdf417"]})}async function S(){if(t==="grabFrame")return C.grabFrame();if(t==="videoCapture")return _;if(t==="takePhoto"){const b=await C.takePhoto(),y=new Image;return y.src=URL.createObjectURL(b),await new Promise(I=>{y.onload=I}),y}}async function g(){const b=await S();return await m.detect(b)}async function T(){try{const b=await C.grabFrame(),y=document.createElement("canvas"),I=y.getContext("2d");y.width=b.width,y.height=b.height,I.drawImage(b,0,0),y.toBlob(R=>{qo(R)})}catch(b){console.log(b)}}function M(b){const y=Date.now()-b;c+=1,r=c>1?(r*(c-1)+y)/c:y,N(I=>({...I,scanCount:c,average:r}))}async function G(){try{const b=Date.now(),y=await g();if(p)return;M(b),y.length>0?(Et("barcode",y[0]),n+=1,l=y[0].rawValue,N(I=>({...I,barcode:l,success:n})),No({file:"Ceres",volume:1})):(o+=1,N(I=>({...I,fail:o})))}catch(b){i+=1,N(y=>({...y,error:i})),console.log(b)}finally{setTimeout(G,100)}}function j(){p=!0,clearInterval(d)}const{subscribe:U,update:N}=ct({mode:t,success:n,fail:o,barcode:l,scanCount:c,error:i,average:r,toggleMode:()=>{const y=(e.indexOf(t)+1)%e.length;t=e[y],N(I=>({...I,mode:t}))},resetStats:()=>{n=0,o=0},resetBarcode:()=>{l=null}});return{init:$,subscribe:U,toggleMode:()=>N(b=>({...b,mode:e[(e.indexOf(b.mode)+1)%e.length]})),resetStats:()=>N(b=>({...b,success:0,fail:0,error:0,scanCount:0,average:0})),resetBarcode:()=>N(b=>({...b,barcode:null})),stop:j,start:()=>{p=!1,G(),d=setInterval(T,5e3)}}}async function Eo(e){const{_deviceId:t,groupId:n,...o}=e,i=new TextEncoder().encode(JSON.stringify(o)),c=await crypto.subtle.digest("SHA-256",i);return Array.from(new Uint8Array(c)).map(p=>p.toString(16).padStart(2,"0")).join("")}function Po(e){var n,o;return`${((((n=e==null?void 0:e.width)==null?void 0:n.max)||0)*(((o=e==null?void 0:e.height)==null?void 0:o.max)||0)/1e6).toFixed(2)} Mpix`}const Kn=async()=>{const t=(await navigator.mediaDevices.enumerateDevices()).filter(({kind:o})=>o==="videoinput");Et("cameras",t);let n=[];for await(const o of t){const i=o.deviceId;try{const c=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:i},facingMode:{exact:"environment"}},audio:!1}),r=c.getTracks()[0],d=r.getConstraints(),p=r.getCapabilities();c.getTracks().forEach(l=>l.stop()),i===p.deviceId&&n.push({camera:o,constraints:d,capabilities:p,hash:await Eo(p)})}catch(c){console.log(c)}}return Et("validCameras",n),n},Lo=()=>{const{subscribe:e,update:t}=ct({cameras:[],selected:void 0});return{subscribe:e,getAvailableCameras:Kn,updateCameras:async()=>{const o=(await Kn()).map(({capabilities:i,hash:c})=>({value:c,label:Po(i)}));console.log("cameras",o),t(i=>({...i,cameras:o}))},setActiveCamera:n=>{t(o=>({...o,selected:n}))}}};function Gn(e,t,n){const o=e.slice();return o[9]=t[n].value,o[26]=t[n].label,o[28]=n,o}function Wn(e){let t,n=e[26]+"",o,i;return{c(){t=u("option"),o=h(n),t.__value=i=e[9],Ce(t,t.__value)},m(c,r){A(c,t,r),s(t,o)},p(c,r){r&256&&n!==(n=c[26]+"")&&q(o,n),r&256&&i!==(i=c[9])&&(t.__value=i,Ce(t,t.__value))},d(c){c&&D(t)}}}function Bo(e){var un,dn,fn,pn,mn,gn,vn,hn,_n,bn,wn,yn,$n,Cn,Sn;let t,n,o,i=e[1].scanCount+"",c,r,d,p,l=e[1].average.toFixed(2)+"",C,m,_,$,S=e[1].fail+"",g,T,M,G,j=e[1].success+"",U,N,b,y,I=((un=e[7])==null?void 0:un.exposureTime)+"",R,De,oe,F,O=((dn=e[7])==null?void 0:dn.contrast)+"",Te,_e,se,Ut,Ie=((fn=e[7])==null?void 0:fn.exposureMode)+"",lt,zt,qe,Ht,Ae=((pn=e[7])==null?void 0:pn.height)+"",at,Jt,Oe,Rt,Ne=((mn=e[7])==null?void 0:mn.width)+"",ut,Vt,ke,Zt,Ee=((gn=e[7])==null?void 0:gn.resizeMode)+"",dt,Kt,Pe,Gt,Le=((vn=e[7])==null?void 0:vn.saturation)+"",ft,Wt,Be,Xt,je=((hn=e[7])==null?void 0:hn.sharpness)+"",pt,mt,V,gt,Ue,vt,z,ie,be,W,ze,Yt,ht,Qt,ce,E,He,xt,Z,_t,Je=((wn=(bn=(_n=e[0])==null?void 0:_n.capabilities)==null?void 0:bn.focusDistance)==null?void 0:wn.min.toFixed(2))+"",bt,en,wt,Re=(e[2]?e[2].toFixed(2):"-")+"",yt,tn,$t,Ve=((Cn=($n=(yn=e[0])==null?void 0:yn.capabilities)==null?void 0:$n.focusDistance)==null?void 0:Cn.max.toFixed(2))+"",Ct,nn,re,we,X,Ze,on,St,Ft,H,Ke,Y,Q,Ge,We,sn,le,Mt,cn,Xe,B,x,rn,ae,Ye=((Sn=e[1])==null?void 0:Sn.mode)+"",Dt,ln,ye,ee,Qe,Tt,an,ue=st(e[8].cameras),k=[];for(let a=0;a<ue.length;a+=1)k[a]=Wn(Gn(e,ue,a));return{c(){var a;t=u("div"),n=u("div"),o=h("Scan count: "),c=h(i),r=w(),d=u("div"),p=h("Average: "),C=h(l),m=w(),_=u("div"),$=h("Fail: "),g=h(S),T=w(),M=u("div"),G=h("Success: "),U=h(j),N=w(),b=u("div"),y=h("exposureTime: "),R=h(I),De=w(),oe=u("div"),F=h("Contrast "),Te=h(O),_e=w(),se=u("div"),Ut=h("exposureMode: "),lt=h(Ie),zt=w(),qe=u("div"),Ht=h("height: "),at=h(Ae),Jt=w(),Oe=u("div"),Rt=h("width: "),ut=h(Ne),Vt=w(),ke=u("div"),Zt=h("resizeMode: "),dt=h(Ee),Kt=w(),Pe=u("div"),Gt=h("saturation: "),ft=h(Le),Wt=w(),Be=u("div"),Xt=h("sharpness: "),pt=h(je),mt=w(),V=u("video"),V.innerHTML="",gt=w(),Ue=u("div"),vt=w(),z=u("div"),ie=u("div"),be=u("button"),W=u("img"),Yt=w(),ht=h(e[6]),Qt=w(),ce=u("div"),E=u("input"),xt=w(),Z=u("div"),_t=u("span"),bt=h(Je),en=w(),wt=u("span"),yt=h(Re),tn=w(),$t=u("span"),Ct=h(Ve),nn=w(),re=u("div"),we=u("button"),X=u("img"),on=w(),St=h(e[3]),Ft=w(),H=u("div"),Ke=u("div"),Y=u("button"),Q=u("img"),sn=w(),le=u("div"),Mt=u("div"),Mt.textContent="build 2024-04-04T14:57:56.040Z",cn=w(),Xe=u("div"),B=u("select"),x=u("option"),x.textContent="Choose camera";for(let v=0;v<k.length;v+=1)k[v].c();rn=w(),ae=u("div"),Dt=h(Ye),ln=w(),ye=u("button"),ee=u("img"),f(t,"class","stats svelte-edqcw0"),V.autoplay=!0,f(V,"id","stream"),f(V,"class","svelte-edqcw0"),f(Ue,"class","overlay svelte-edqcw0"),K(W.src,ze=`public/${e[6]}-focus.svg`)||f(W,"src",ze),f(W,"class","svelte-edqcw0"),f(be,"class","svelte-edqcw0"),f(ie,"class","focus__group svelte-edqcw0"),E.disabled=He=e[6]==="continuous",f(E,"id","zoom__range"),f(E,"type","range"),f(E,"min","0"),f(E,"max","100"),f(E,"class","svelte-edqcw0"),f(Z,"class","focus__range svelte-edqcw0"),f(ce,"class","focus__group grow svelte-edqcw0"),K(X.src,Ze=`public/${e[3]}-facingMode.svg`)||f(X,"src",Ze),f(X,"class","svelte-edqcw0"),f(we,"class","svelte-edqcw0"),f(re,"class","focus__group svelte-edqcw0"),f(z,"id","focus"),f(z,"class","svelte-edqcw0"),K(Q.src,Ge=`public/torch-${e[4]?"on":"off"}.svg`)||f(Q,"src",Ge),f(Q,"class","svelte-edqcw0"),Y.disabled=We=!e[0]||!e[0].capabilities.torch,f(Y,"class","svelte-edqcw0"),f(Ke,"class","focus__group svelte-edqcw0"),x.__value="",Ce(x,x.__value),x.disabled=!0,f(B,"class","svelte-edqcw0"),e[9]===void 0&&ot(()=>e[19].call(B)),f(Xe,"class","custom-select svelte-edqcw0"),f(le,"class","build svelte-edqcw0"),K(ee.src,Qe=`public/mode-${(a=e[1])==null?void 0:a.mode}.svg`)||f(ee,"src",Qe),f(ee,"class","svelte-edqcw0"),f(ye,"class","svelte-edqcw0"),f(ae,"class","focus__group svelte-edqcw0"),f(H,"id","toggles"),f(H,"class","svelte-edqcw0")},m(a,v){var $e;A(a,t,v),s(t,n),s(n,o),s(n,c),s(t,r),s(t,d),s(d,p),s(d,C),s(t,m),s(t,_),s(_,$),s(_,g),s(t,T),s(t,M),s(M,G),s(M,U),s(t,N),s(t,b),s(b,y),s(b,R),s(t,De),s(t,oe),s(oe,F),s(oe,Te),s(t,_e),s(t,se),s(se,Ut),s(se,lt),s(t,zt),s(t,qe),s(qe,Ht),s(qe,at),s(t,Jt),s(t,Oe),s(Oe,Rt),s(Oe,ut),s(t,Vt),s(t,ke),s(ke,Zt),s(ke,dt),s(t,Kt),s(t,Pe),s(Pe,Gt),s(Pe,ft),s(t,Wt),s(t,Be),s(Be,Xt),s(Be,pt),A(a,mt,v),A(a,V,v),e[17](V),A(a,gt,v),A(a,Ue,v),A(a,vt,v),A(a,z,v),s(z,ie),s(ie,be),s(be,W),s(ie,Yt),s(ie,ht),s(z,Qt),s(z,ce),s(ce,E),Ce(E,e[9]),s(ce,xt),s(ce,Z),s(Z,_t),s(_t,bt),s(Z,en),s(Z,wt),s(wt,yt),s(Z,tn),s(Z,$t),s($t,Ct),s(z,nn),s(z,re),s(re,we),s(we,X),s(re,on),s(re,St),A(a,Ft,v),A(a,H,v),s(H,Ke),s(Ke,Y),s(Y,Q),s(H,sn),s(H,le),s(le,Mt),s(le,cn),s(le,Xe),s(Xe,B),s(B,x);for(let te=0;te<k.length;te+=1)k[te]&&k[te].m(B,null);Hn(B,e[9],!0),s(H,rn),s(H,ae),s(ae,Dt),s(ae,ln),s(ae,ye),s(ye,ee),Tt||(an=[J(be,"click",e[15]),J(E,"change",e[18]),J(E,"input",e[18]),J(E,"change",e[10]),J(we,"click",e[16]),J(Y,"click",e[11]),J(B,"change",e[19]),J(B,"change",e[14]),J(ye,"click",($e=e[13])==null?void 0:$e.toggleMode)],Tt=!0)},p(a,[v]){var $e,te,Fn,Mn,Dn,Tn,In,qn,An,On,Nn,kn,En,Pn,Ln,Bn;if(v&2&&i!==(i=a[1].scanCount+"")&&q(c,i),v&2&&l!==(l=a[1].average.toFixed(2)+"")&&q(C,l),v&2&&S!==(S=a[1].fail+"")&&q(g,S),v&2&&j!==(j=a[1].success+"")&&q(U,j),v&128&&I!==(I=(($e=a[7])==null?void 0:$e.exposureTime)+"")&&q(R,I),v&128&&O!==(O=((te=a[7])==null?void 0:te.contrast)+"")&&q(Te,O),v&128&&Ie!==(Ie=((Fn=a[7])==null?void 0:Fn.exposureMode)+"")&&q(lt,Ie),v&128&&Ae!==(Ae=((Mn=a[7])==null?void 0:Mn.height)+"")&&q(at,Ae),v&128&&Ne!==(Ne=((Dn=a[7])==null?void 0:Dn.width)+"")&&q(ut,Ne),v&128&&Ee!==(Ee=((Tn=a[7])==null?void 0:Tn.resizeMode)+"")&&q(dt,Ee),v&128&&Le!==(Le=((In=a[7])==null?void 0:In.saturation)+"")&&q(ft,Le),v&128&&je!==(je=((qn=a[7])==null?void 0:qn.sharpness)+"")&&q(pt,je),v&64&&!K(W.src,ze=`public/${a[6]}-focus.svg`)&&f(W,"src",ze),v&64&&q(ht,a[6]),v&64&&He!==(He=a[6]==="continuous")&&(E.disabled=He),v&768&&Ce(E,a[9]),v&1&&Je!==(Je=((Nn=(On=(An=a[0])==null?void 0:An.capabilities)==null?void 0:On.focusDistance)==null?void 0:Nn.min.toFixed(2))+"")&&q(bt,Je),v&4&&Re!==(Re=(a[2]?a[2].toFixed(2):"-")+"")&&q(yt,Re),v&1&&Ve!==(Ve=((Pn=(En=(kn=a[0])==null?void 0:kn.capabilities)==null?void 0:En.focusDistance)==null?void 0:Pn.max.toFixed(2))+"")&&q(Ct,Ve),v&8&&!K(X.src,Ze=`public/${a[3]}-facingMode.svg`)&&f(X,"src",Ze),v&8&&q(St,a[3]),v&16&&!K(Q.src,Ge=`public/torch-${a[4]?"on":"off"}.svg`)&&f(Q,"src",Ge),v&1&&We!==(We=!a[0]||!a[0].capabilities.torch)&&(Y.disabled=We),v&256){ue=st(a[8].cameras);let L;for(L=0;L<ue.length;L+=1){const jn=Gn(a,ue,L);k[L]?k[L].p(jn,v):(k[L]=Wn(jn),k[L].c(),k[L].m(B,null))}for(;L<k.length;L+=1)k[L].d(1);k.length=ue.length}v&768&&Hn(B,a[9]),v&2&&Ye!==(Ye=((Ln=a[1])==null?void 0:Ln.mode)+"")&&q(Dt,Ye),v&2&&!K(ee.src,Qe=`public/mode-${(Bn=a[1])==null?void 0:Bn.mode}.svg`)&&f(ee,"src",Qe)},i:P,o:P,d(a){a&&(D(t),D(mt),D(V),D(gt),D(Ue),D(vt),D(z),D(Ft),D(H)),e[17](null),eo(k,a),Tt=!1,he(an)}}}function jo(e,t,n){let o,i,c=0,r,d="environment",p=!1;async function l(F){console.log(F.target.value),n(9,c=F.target.value);const O=await(g==null?void 0:g.setFocusDistancePct(c));n(2,r=O||void 0)}async function C(){n(4,p=!p),await(g==null?void 0:g.setTorch(p))}const m=F=>navigator.mediaDevices.getUserMedia({video:{...F?{deviceId:{exact:F}}:{},facingMode:d,aspectRatio:{exact:1.7777777778}},audio:!1});let _,$,S,g,T=Lo();nt(e,T,F=>n(8,i=F));let M=ko();nt(e,M,F=>n(1,o=F));async function G(F){const O=F.target.value;console.log(O),T.setActiveCamera(O),await N(O)}const j=["continuous","manual"];let U="continuous";const N=async F=>{try{S==null||S.stop(),M==null||M.stop();let O;if(F){const _e=(await T.getAvailableCameras()).find(se=>se.hash===F);if(!_e){alert("Camera not found");return}O=_e.deviceId}$=await m(O),S=$.getVideoTracks()[0],n(5,_.srcObject=$,_),n(0,g=Ao(S)),M.init(_,S,_.width,_.height),M.start()}catch(O){console.log("error",O),alert("Could not access the camera")}},b=async()=>{const F=j[j.indexOf(U)+1]||j[0];try{await g.setFocusMode(U),n(6,U=F)}catch{alert("Could not set focus mode")}},y=async()=>{n(3,d=d==="environment"?"user":"environment"),await N()};po(()=>((async()=>(await T.updateCameras(),await N()))(),()=>M==null?void 0:M.stop()));let I;function R(F){Nt[F?"unshift":"push"](()=>{_=F,n(5,_)})}function De(){c=lo(this.value),n(9,c)}function oe(){c=uo(this),n(9,c)}return e.$$.update=()=>{e.$$.dirty&3&&(o==null||o.scanCount,n(7,I=g==null?void 0:g.getSettings()))},[g,o,r,d,p,_,U,I,i,c,l,C,T,M,G,b,y,R,De,oe]}class Uo extends jt{constructor(t){super(),Bt(this,t,jo,Bo,it,{})}}const At="deviceAlias",zo=()=>{const{subscribe:e,set:t}=ct(localStorage.getItem(At));return{subscribe:e,ask:()=>{if(localStorage.getItem(At))return;let n=prompt("Please input your device alias","device");n?(localStorage.setItem(At,n),t(n)):alert("You must provide a device alias")}}},Xn=zo();function Ho(e){let t;return{c(){t=u("h1"),t.textContent="BarcodeDetector not supported."},m(n,o){A(n,t,o)},d(n){n&&D(t)}}}function Jo(e){let t;return{c(){t=u("h1"),t.textContent="Waiting for device alias..."},m(n,o){A(n,t,o)},i:P,o:P,d(n){n&&D(t)}}}function Ro(e){let t,n;return t=new Uo({}),{c(){no(t.$$.fragment)},m(o,i){Pt(t,o,i),n=!0},i(o){n||(Fe(t.$$.fragment,o),n=!0)},o(o){tt(t.$$.fragment,o),n=!1},d(o){Lt(t,o)}}}function Vo(e){let t,n,o,i,c,r,d,p,l,C;o=new Mo({});let m=!e[1]&&Ho();const _=[Ro,Jo],$=[];function S(g,T){return g[0]?0:1}return d=S(e),p=$[d]=_[d](e),{c(){t=u("meta"),n=w(),no(o.$$.fragment),i=w(),c=u("main"),m&&m.c(),r=w(),p.c(),l=ro(),f(t,"name","viewport"),f(t,"content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")},m(g,T){s(document.head,t),A(g,n,T),Pt(o,g,T),A(g,i,T),A(g,c,T),m&&m.m(c,null),A(g,r,T),$[d].m(g,T),A(g,l,T),C=!0},p(g,[T]){let M=d;d=S(g),d!==M&&(_o(),tt($[M],1,1,()=>{$[M]=null}),bo(),p=$[d],p||(p=$[d]=_[d](g),p.c()),Fe(p,1),p.m(l.parentNode,l))},i(g){C||(Fe(o.$$.fragment,g),Fe(p),C=!0)},o(g){tt(o.$$.fragment,g),tt(p),C=!1},d(g){g&&(D(n),D(i),D(c),D(r),D(l)),D(t),Lt(o,g),m&&m.d(),$[d].d(g)}}}function Zo(e,t,n){let o;nt(e,Xn,c=>n(0,o=c));const i=typeof BarcodeDetector<"u";return Xn.ask(),[o,i]}class Ko extends jt{constructor(t){super(),Bt(this,t,Zo,Vo,it,{})}}const Ot="0.0.13",Yn=localStorage.getItem("version");Ot!==Yn&&(localStorage.setItem("version",Ot),alert(`New version detected ${Yn}>${Ot}!`));new Ko({target:document.getElementById("app")});
