var Un=Object.defineProperty;var qn=(e,t,n)=>t in e?Un(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var dt=(e,t,n)=>(qn(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();function P(){}function Ln(e){return e()}function Cn(){return Object.create(null)}function ie(e){e.forEach(Ln)}function Bn(e){return typeof e=="function"}function Ve(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let Ue;function q(e,t){return e===t?!0:(Ue||(Ue=document.createElement("a")),Ue.href=t,e===Ue.href)}function Rn(e){return Object.keys(e).length===0}function Vn(e,...t){if(e==null){for(const s of t)s(void 0);return P}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function _t(e,t,n){e.$$.on_destroy.push(Vn(t,n))}function Dn(e){return e??""}function o(e,t){e.appendChild(t)}function T(e,t,n){e.insertBefore(t,n||null)}function C(e){e.parentNode&&e.parentNode.removeChild(e)}function Zn(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function y(){return h(" ")}function Hn(){return h("")}function R(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function p(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Jn(e){return e===""?null:+e}function Kn(e){return Array.from(e.childNodes)}function D(e,t){t=""+t,e.data!==t&&(e.data=t)}function Mn(e,t){e.value=t??""}let de;function ue(e){de=e}function Wn(){if(!de)throw new Error("Function called outside component initialization");return de}function Xn(e){Wn().$$.on_mount.push(e)}const se=[],mt=[];let oe=[];const Tn=[],Yn=Promise.resolve();let vt=!1;function Gn(){vt||(vt=!0,Yn.then(zn))}function ht(e){oe.push(e)}const pt=new Set;let ee=0;function zn(){if(ee!==0)return;const e=de;do{try{for(;ee<se.length;){const t=se[ee];ee++,ue(t),Qn(t.$$)}}catch(t){throw se.length=0,ee=0,t}for(ue(null),se.length=0,ee=0;mt.length;)mt.pop()();for(let t=0;t<oe.length;t+=1){const n=oe[t];pt.has(n)||(pt.add(n),n())}oe.length=0}while(se.length);for(;Tn.length;)Tn.pop()();vt=!1,pt.clear(),ue(e)}function Qn(e){if(e.fragment!==null){e.update(),ie(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ht)}}function xn(e){const t=[],n=[];oe.forEach(s=>e.indexOf(s)===-1?t.push(s):n.push(s)),n.forEach(s=>s()),oe=t}const qe=new Set;let X;function es(){X={r:0,c:[],p:X}}function ts(){X.r||ie(X.c),X=X.p}function fe(e,t){e&&e.i&&(qe.delete(e),e.i(t))}function Re(e,t,n,s){if(e&&e.o){if(qe.has(e))return;qe.add(e),X.c.push(()=>{qe.delete(e),s&&(n&&e.d(1),s())}),e.o(t)}else s&&s()}function In(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function jn(e){e&&e.c()}function bt(e,t,n){const{fragment:s,after_update:i}=e.$$;s&&s.m(t,n),ht(()=>{const c=e.$$.on_mount.map(Ln).filter(Bn);e.$$.on_destroy?e.$$.on_destroy.push(...c):ie(c),e.$$.on_mount=[]}),i.forEach(ht)}function wt(e,t){const n=e.$$;n.fragment!==null&&(xn(n.after_update),ie(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ns(e,t){e.$$.dirty[0]===-1&&(se.push(e),Gn(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function yt(e,t,n,s,i,c,l=null,f=[-1]){const v=de;ue(e);const r=e.$$={fragment:null,ctx:[],props:c,update:P,not_equal:i,bound:Cn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(v?v.$$.context:[])),callbacks:Cn(),dirty:f,skip_bound:!1,root:t.target||v.$$.root};l&&l(r.root);let F=!1;if(r.ctx=n?n(e,t.props||{},(a,k,...b)=>{const $=b.length?b[0]:k;return r.ctx&&i(r.ctx[a],r.ctx[a]=$)&&(!r.skip_bound&&r.bound[a]&&r.bound[a]($),F&&ns(e,a)),k}):[],r.update(),F=!0,ie(r.before_update),r.fragment=s?s(r.ctx):!1,t.target){if(t.hydrate){const a=Kn(t.target);r.fragment&&r.fragment.l(a),a.forEach(C)}else r.fragment&&r.fragment.c();t.intro&&fe(e.$$.fragment),bt(e,t.target,t.anchor),zn()}ue(v)}class kt{constructor(){dt(this,"$$");dt(this,"$$set")}$destroy(){wt(this,1),this.$destroy=P}$on(t,n){if(!Bn(n))return P;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!Rn(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ss="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ss);const te=[];function $t(e,t=P){let n;const s=new Set;function i(f){if(Ve(e,f)&&(e=f,n)){const v=!te.length;for(const r of s)r[1](),te.push(r,e);if(v){for(let r=0;r<te.length;r+=2)te[r][0](te[r+1]);te.length=0}}}function c(f){i(f(e))}function l(f,v=P){const r=[f,v];return s.add(r),s.size===1&&(n=t(i,c)||P),f(e),()=>{s.delete(r),s.size===0&&n&&(n(),n=null)}}return{set:i,update:c,subscribe:l}}let On=0;const os=3e3;function is(){const{subscribe:e,update:t}=$t([]);function n(i){On+=1;const c=On,l={...i,id:c};t(f=>[...f,l].slice(-5)),setTimeout(()=>{s(c)},os)}function s(i){t(c=>c.filter(l=>l.id!==i))}return{subscribe:e,addNotification:n,closeNotification:s}}const pe=is();function Nn(e,t,n){const s=e.slice();return s[2]=t[n],s}function Pn(e){let t,n,s=e[2].text+"",i,c,l,f,v,r,F;function a(){return e[1](e[2])}return{c(){t=u("div"),n=u("div"),i=h(s),c=y(),l=u("button"),l.textContent="X",f=y(),p(l,"class","svelte-1mipv5u"),p(t,"class",v=Dn(`notification ${e[2].type}`)+" svelte-1mipv5u")},m(k,b){T(k,t,b),o(t,n),o(n,i),o(t,c),o(t,l),o(t,f),r||(F=R(l,"click",a),r=!0)},p(k,b){e=k,b&1&&s!==(s=e[2].text+"")&&D(i,s),b&1&&v!==(v=Dn(`notification ${e[2].type}`)+" svelte-1mipv5u")&&p(t,"class",v)},d(k){k&&C(t),r=!1,F()}}}function cs(e){let t,n=In(e[0]),s=[];for(let i=0;i<n.length;i+=1)s[i]=Pn(Nn(e,n,i));return{c(){t=u("div");for(let i=0;i<s.length;i+=1)s[i].c();p(t,"id","notifications-container"),p(t,"class","svelte-1mipv5u")},m(i,c){T(i,t,c);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(t,null)},p(i,[c]){if(c&1){n=In(i[0]);let l;for(l=0;l<n.length;l+=1){const f=Nn(i,n,l);s[l]?s[l].p(f,c):(s[l]=Pn(f),s[l].c(),s[l].m(t,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=n.length}},i:P,o:P,d(i){i&&C(t),Zn(s,i)}}}function ls(e,t,n){let s;return _t(e,pe,c=>n(0,s=c)),[s,c=>pe.closeNotification(c.id)]}class rs extends kt{constructor(t){super(),yt(this,t,ls,cs,Ve,{})}}const as="https://yup.perfdive.com/api",St=async(e,t)=>{const n=await fetch(`${as}${e}`,t);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return n},us=async e=>{try{return await St("/log",{method:"POST",headers:{"Content-Type":"application/json",device:localStorage.getItem("deviceAlias"),event:"trackCapabilities"},body:JSON.stringify(e)})}catch(t){console.error(t),pe.addNotification({text:"sendTrackCapabilities failed, "+t.message,type:"error"})}},fs=async e=>{try{return await St("/log",{method:"POST",headers:{"Content-Type":"application/json",device:localStorage.getItem("deviceAlias"),event:"trackSettings"},body:JSON.stringify(e)})}catch(t){console.error(t),pe.addNotification({text:"sendTrackSettings failed, "+t.message,type:"error"})}},ds=async e=>{const t=new FormData;t.append("photo",e);try{const n=await St("/upload",{method:"POST",body:t,headers:{device:localStorage.getItem("deviceAlias"),event:"trackSettings"}})}catch(n){console.error(n),pe.addNotification({text:"sendPhoto failed, "+n.message,type:"error"})}},ps=e=>{const t=e.getCapabilities(),n=e.getSettings();return us(t),fs(n),{capabilities:t,canAutoFocus:()=>t.focusDistance&&t.focusMode&&(t==null?void 0:t.focusMode.includes("manual"))||!1,getFocusDistance:()=>{const{focusDistance:a}=t;return a&&(a.max-a.min)/a.step,a},getSettings:()=>e.getSettings(),setFocusMode:a=>e.applyConstraints({advanced:[{focusMode:a}]}),setFocusDistance:a=>e.applyConstraints({advanced:[{focusMode:"manual",focusDistance:a}]}),setTorch:a=>{t.torch&&e.applyConstraints({advanced:[{torch:a}]})},settings:n,setFocusDistancePct:async a=>{const{focusDistance:k}=t;if(!k){alert("Focus distance not supported");return}const b=(k.max-k.min)/100,$=k.min+b*a;try{await e.applyConstraints({advanced:[{focusMode:"manual",focusDistance:$}]})}catch(g){alert(g.message),console.error(g)}return $},setZoom:a=>e.applyConstraints({advanced:[{zoom:a}]})}},gs=.1;let ne;const ms=({file:e,volume:t})=>{ne==null||ne.pause(),ne=new Audio(`public/sounds/${e}.ogg`),ne.volume=t||gs,ne.play()};function vs(){const e=["grabFrame","videoCapture","processor"];let t="videoCapture",n=0,s=0,i=0,c=0,l=0,f,v=!1,r=null,F,a,k;function b(_,S,w,A){k=_,F=new ImageCapture(S),a=new BarcodeDetector({formats:["pdf417"]})}async function $(){if(t==="grabFrame")return F.grabFrame();if(t==="videoCapture"||t==="processor")return k;if(t==="takePhoto"){const _=await F.takePhoto(),S=new Image;return S.src=URL.createObjectURL(_),await new Promise(w=>{S.onload=w}),S}}async function g(){const _=await $();return a.detect(_)}async function M(){try{const _=await F.grabFrame(),S=document.createElement("canvas"),w=S.getContext("2d");S.width=_.width,S.height=_.height,w.drawImage(_,0,0),S.toBlob(A=>{ds(A)})}catch(_){console.log(_)}}function I(_){const S=Date.now()-_;c+=1,l=c>1?(l*(c-1)+S)/c:S,O(w=>({...w,scanCount:c,average:l}))}async function L(){try{const _=Date.now(),S=await g();if(v)return;I(_),S.length>0?(n+=1,r=S[0].rawValue,O(w=>({...w,barcode:r,success:n})),ms({file:"Ceres",volume:1})):(s+=1,O(w=>({...w,fail:s})))}catch(_){i+=1,O(S=>({...S,error:i})),console.log(_)}finally{setTimeout(L,100)}}function B(){v=!0,clearInterval(f)}const{subscribe:V,update:O}=$t({mode:t,success:n,fail:s,barcode:r,scanCount:c,error:i,average:l,toggleMode:()=>{const S=(e.indexOf(t)+1)%e.length;t=e[S],O(w=>({...w,mode:t}))},resetStats:()=>{n=0,s=0},resetBarcode:()=>{r=null}});return{init:b,subscribe:V,toggleMode:()=>O(_=>({..._,mode:e[(e.indexOf(_.mode)+1)%e.length]})),resetStats:()=>O(_=>({..._,success:0,fail:0,error:0,scanCount:0,average:0})),resetBarcode:()=>O(_=>({..._,barcode:null})),stop:B,start:()=>{v=!1,L(),f=setInterval(M,5e3)}}}function hs(e){var Xt,Yt,Gt,Qt,xt,en,tn,nn,sn,on,cn,ln,rn,an,un;let t,n,s,i=e[1].scanCount+"",c,l,f,v,r=e[1].average.toFixed(2)+"",F,a,k,b,$=e[1].fail+"",g,M,I,L,B=e[1].success+"",V,O,_,S,w=((Xt=e[8])==null?void 0:Xt.exposureTime)+"",A,Ft,ge,Ct,me=((Yt=e[8])==null?void 0:Yt.contrast)+"",Ze,Dt,ve,Mt,he=((Gt=e[8])==null?void 0:Gt.exposureMode)+"",He,Tt,_e,It,be=((Qt=e[8])==null?void 0:Qt.height)+"",Je,Ot,we,Nt,ye=((xt=e[8])==null?void 0:xt.width)+"",Ke,Pt,ke,Et,$e=((en=e[8])==null?void 0:en.resizeMode)+"",We,At,Se,Lt,Fe=((tn=e[8])==null?void 0:tn.saturation)+"",Xe,Bt,Ce,zt,De=((nn=e[8])==null?void 0:nn.sharpness)+"",Ye,Ge,z,Qe,Me,xe,E,Y,ce,Z,Te,jt,et,Ut,G,N,Ie,qt,j,tt,Oe=((cn=(on=(sn=e[0])==null?void 0:sn.capabilities)==null?void 0:on.focusDistance)==null?void 0:cn.min.toFixed(2))+"",nt,Rt,st,Ne=(e[3]?e[3].toFixed(2):"-")+"",ot,Vt,it,Pe=((an=(rn=(ln=e[0])==null?void 0:ln.capabilities)==null?void 0:rn.focusDistance)==null?void 0:an.max.toFixed(2))+"",ct,Zt,Q,le,H,Ee,Ht,lt,rt,U,Ae,J,K,Le,Be,Jt,at,x,ze=((un=e[1])==null?void 0:un.mode)+"",ut,Kt,re,W,je,ft,Wt;return{c(){var d;t=u("div"),n=u("div"),s=h("Scan count: "),c=h(i),l=y(),f=u("div"),v=h("Average: "),F=h(r),a=y(),k=u("div"),b=h("Fail: "),g=h($),M=y(),I=u("div"),L=h("Success: "),V=h(B),O=y(),_=u("div"),S=h("exposureTime: "),A=h(w),Ft=y(),ge=u("div"),Ct=h("Contrast "),Ze=h(me),Dt=y(),ve=u("div"),Mt=h("exposureMode: "),He=h(he),Tt=y(),_e=u("div"),It=h("height: "),Je=h(be),Ot=y(),we=u("div"),Nt=h("width: "),Ke=h(ye),Pt=y(),ke=u("div"),Et=h("resizeMode: "),We=h($e),At=y(),Se=u("div"),Lt=h("saturation: "),Xe=h(Fe),Bt=y(),Ce=u("div"),zt=h("sharpness: "),Ye=h(De),Ge=y(),z=u("video"),z.innerHTML="",Qe=y(),Me=u("div"),xe=y(),E=u("div"),Y=u("div"),ce=u("button"),Z=u("img"),jt=y(),et=h(e[7]),Ut=y(),G=u("div"),N=u("input"),qt=y(),j=u("div"),tt=u("span"),nt=h(Oe),Rt=y(),st=u("span"),ot=h(Ne),Vt=y(),it=u("span"),ct=h(Pe),Zt=y(),Q=u("div"),le=u("button"),H=u("img"),Ht=y(),lt=h(e[4]),rt=y(),U=u("div"),Ae=u("div"),J=u("button"),K=u("img"),Jt=y(),at=u("div"),x=u("div"),ut=h(ze),Kt=y(),re=u("button"),W=u("img"),p(t,"class","stats svelte-ikwksb"),z.autoplay=!0,p(z,"id","stream"),p(z,"class","svelte-ikwksb"),p(Me,"class","overlay svelte-ikwksb"),q(Z.src,Te=`public/${e[7]}-focus.svg`)||p(Z,"src",Te),p(Z,"class","svelte-ikwksb"),p(ce,"class","svelte-ikwksb"),p(Y,"class","focus__group svelte-ikwksb"),N.disabled=Ie=e[7]==="continuous",p(N,"id","zoom__range"),p(N,"type","range"),p(N,"min","0"),p(N,"max","100"),p(N,"class","svelte-ikwksb"),p(j,"class","focus__range svelte-ikwksb"),p(G,"class","focus__group grow svelte-ikwksb"),q(H.src,Ee=`public/${e[4]}-facingMode.svg`)||p(H,"src",Ee),p(H,"class","svelte-ikwksb"),p(le,"class","svelte-ikwksb"),p(Q,"class","focus__group svelte-ikwksb"),p(E,"id","focus"),p(E,"class","svelte-ikwksb"),q(K.src,Le=`public/torch-${e[5]?"on":"off"}.svg`)||p(K,"src",Le),p(K,"class","svelte-ikwksb"),J.disabled=Be=!e[0]||!e[0].capabilities.torch,p(J,"class","svelte-ikwksb"),p(Ae,"class","focus__group svelte-ikwksb"),q(W.src,je=`public/mode-${(d=e[1])==null?void 0:d.mode}.svg`)||p(W,"src",je),p(W,"class","svelte-ikwksb"),p(re,"class","svelte-ikwksb"),p(x,"class","focus__group svelte-ikwksb"),p(U,"id","toggles"),p(U,"class","svelte-ikwksb")},m(d,m){var ae;T(d,t,m),o(t,n),o(n,s),o(n,c),o(t,l),o(t,f),o(f,v),o(f,F),o(t,a),o(t,k),o(k,b),o(k,g),o(t,M),o(t,I),o(I,L),o(I,V),o(t,O),o(t,_),o(_,S),o(_,A),o(t,Ft),o(t,ge),o(ge,Ct),o(ge,Ze),o(t,Dt),o(t,ve),o(ve,Mt),o(ve,He),o(t,Tt),o(t,_e),o(_e,It),o(_e,Je),o(t,Ot),o(t,we),o(we,Nt),o(we,Ke),o(t,Pt),o(t,ke),o(ke,Et),o(ke,We),o(t,At),o(t,Se),o(Se,Lt),o(Se,Xe),o(t,Bt),o(t,Ce),o(Ce,zt),o(Ce,Ye),T(d,Ge,m),T(d,z,m),e[14](z),T(d,Qe,m),T(d,Me,m),T(d,xe,m),T(d,E,m),o(E,Y),o(Y,ce),o(ce,Z),o(Y,jt),o(Y,et),o(E,Ut),o(E,G),o(G,N),Mn(N,e[2]),o(G,qt),o(G,j),o(j,tt),o(tt,nt),o(j,Rt),o(j,st),o(st,ot),o(j,Vt),o(j,it),o(it,ct),o(E,Zt),o(E,Q),o(Q,le),o(le,H),o(Q,Ht),o(Q,lt),T(d,rt,m),T(d,U,m),o(U,Ae),o(Ae,J),o(J,K),o(U,Jt),o(U,at),o(at,x),o(x,ut),o(x,Kt),o(x,re),o(re,W),ft||(Wt=[R(ce,"click",e[12]),R(N,"change",e[15]),R(N,"input",e[15]),R(N,"change",e[9]),R(le,"click",e[13]),R(J,"click",e[10]),R(re,"click",(ae=e[11])==null?void 0:ae.toggleMode)],ft=!0)},p(d,[m]){var ae,fn,dn,pn,gn,mn,vn,hn,_n,bn,wn,yn,kn,$n,Sn,Fn;m&2&&i!==(i=d[1].scanCount+"")&&D(c,i),m&2&&r!==(r=d[1].average.toFixed(2)+"")&&D(F,r),m&2&&$!==($=d[1].fail+"")&&D(g,$),m&2&&B!==(B=d[1].success+"")&&D(V,B),m&256&&w!==(w=((ae=d[8])==null?void 0:ae.exposureTime)+"")&&D(A,w),m&256&&me!==(me=((fn=d[8])==null?void 0:fn.contrast)+"")&&D(Ze,me),m&256&&he!==(he=((dn=d[8])==null?void 0:dn.exposureMode)+"")&&D(He,he),m&256&&be!==(be=((pn=d[8])==null?void 0:pn.height)+"")&&D(Je,be),m&256&&ye!==(ye=((gn=d[8])==null?void 0:gn.width)+"")&&D(Ke,ye),m&256&&$e!==($e=((mn=d[8])==null?void 0:mn.resizeMode)+"")&&D(We,$e),m&256&&Fe!==(Fe=((vn=d[8])==null?void 0:vn.saturation)+"")&&D(Xe,Fe),m&256&&De!==(De=((hn=d[8])==null?void 0:hn.sharpness)+"")&&D(Ye,De),m&128&&!q(Z.src,Te=`public/${d[7]}-focus.svg`)&&p(Z,"src",Te),m&128&&D(et,d[7]),m&128&&Ie!==(Ie=d[7]==="continuous")&&(N.disabled=Ie),m&4&&Mn(N,d[2]),m&1&&Oe!==(Oe=((wn=(bn=(_n=d[0])==null?void 0:_n.capabilities)==null?void 0:bn.focusDistance)==null?void 0:wn.min.toFixed(2))+"")&&D(nt,Oe),m&8&&Ne!==(Ne=(d[3]?d[3].toFixed(2):"-")+"")&&D(ot,Ne),m&1&&Pe!==(Pe=(($n=(kn=(yn=d[0])==null?void 0:yn.capabilities)==null?void 0:kn.focusDistance)==null?void 0:$n.max.toFixed(2))+"")&&D(ct,Pe),m&16&&!q(H.src,Ee=`public/${d[4]}-facingMode.svg`)&&p(H,"src",Ee),m&16&&D(lt,d[4]),m&32&&!q(K.src,Le=`public/torch-${d[5]?"on":"off"}.svg`)&&p(K,"src",Le),m&1&&Be!==(Be=!d[0]||!d[0].capabilities.torch)&&(J.disabled=Be),m&2&&ze!==(ze=((Sn=d[1])==null?void 0:Sn.mode)+"")&&D(ut,ze),m&2&&!q(W.src,je=`public/mode-${(Fn=d[1])==null?void 0:Fn.mode}.svg`)&&p(W,"src",je)},i:P,o:P,d(d){d&&(C(t),C(Ge),C(z),C(Qe),C(Me),C(xe),C(E),C(rt),C(U)),e[14](null),ft=!1,ie(Wt)}}}function _s(e,t,n){let s,i=0,c,l="environment",f=!1;async function v(w){console.log(w.target.value),n(2,i=w.target.value);const A=await($==null?void 0:$.setFocusDistancePct(i));n(3,c=A||void 0)}async function r(){n(5,f=!f),await($==null?void 0:$.setTorch(f))}const F=()=>navigator.mediaDevices.getUserMedia({video:{facingMode:l,aspectRatio:{exact:1.7777777778}},audio:!1});let a,k,b,$,g=vs();_t(e,g,w=>n(1,s=w));const M=["continuous","manual"];let I="continuous";const L=async()=>{try{b==null||b.stop(),g==null||g.stop(),k=await F(),b=k.getVideoTracks()[0],n(0,$=ps(b)),g.init(a,b,a.width,a.height),g.start()}catch(w){console.log("error",w),alert("Could not access the camera")}},B=async()=>{const w=M[M.indexOf(I)+1]||M[0];try{await $.setFocusMode(I),n(7,I=w)}catch{alert("Could not set focus mode")}},V=async()=>{n(4,l=l==="environment"?"user":"environment"),await L()};Xn(()=>((async()=>await L())(),()=>g==null?void 0:g.stop()));let O;function _(w){mt[w?"unshift":"push"](()=>{a=w,n(6,a)})}function S(){i=Jn(this.value),n(2,i)}return e.$$.update=()=>{e.$$.dirty&3&&(s==null||s.scanCount,n(8,O=$==null?void 0:$.getSettings()))},[$,s,i,c,l,f,a,I,O,v,r,g,B,V,_,S]}class bs extends kt{constructor(t){super(),yt(this,t,_s,hs,Ve,{})}}const gt="deviceAlias",ws=()=>{const{subscribe:e,set:t}=$t(localStorage.getItem(gt));return{subscribe:e,ask:()=>{if(localStorage.getItem(gt))return;let n=prompt("Please input your device alias","device");n?(localStorage.setItem(gt,n),t(n)):alert("You must provide a device alias")}}},En=ws();function ys(e){let t;return{c(){t=u("h1"),t.textContent="BarcodeDetector not supported."},m(n,s){T(n,t,s)},d(n){n&&C(t)}}}function ks(e){let t;return{c(){t=u("h1"),t.textContent="Waiting for device alias..."},m(n,s){T(n,t,s)},i:P,o:P,d(n){n&&C(t)}}}function $s(e){let t,n;return t=new bs({}),{c(){jn(t.$$.fragment)},m(s,i){bt(t,s,i),n=!0},i(s){n||(fe(t.$$.fragment,s),n=!0)},o(s){Re(t.$$.fragment,s),n=!1},d(s){wt(t,s)}}}function Ss(e){let t,n,s,i,c,l,f,v,r,F;s=new rs({});let a=!e[1]&&ys();const k=[$s,ks],b=[];function $(g,M){return g[0]?0:1}return f=$(e),v=b[f]=k[f](e),{c(){t=u("meta"),n=y(),jn(s.$$.fragment),i=y(),c=u("main"),a&&a.c(),l=y(),v.c(),r=Hn(),p(t,"name","viewport"),p(t,"content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")},m(g,M){o(document.head,t),T(g,n,M),bt(s,g,M),T(g,i,M),T(g,c,M),a&&a.m(c,null),T(g,l,M),b[f].m(g,M),T(g,r,M),F=!0},p(g,[M]){let I=f;f=$(g),f!==I&&(es(),Re(b[I],1,1,()=>{b[I]=null}),ts(),v=b[f],v||(v=b[f]=k[f](g),v.c()),fe(v,1),v.m(r.parentNode,r))},i(g){F||(fe(s.$$.fragment,g),fe(v),F=!0)},o(g){Re(s.$$.fragment,g),Re(v),F=!1},d(g){g&&(C(n),C(i),C(c),C(l),C(r)),C(t),wt(s,g),a&&a.d(),b[f].d(g)}}}function Fs(e,t,n){let s;_t(e,En,c=>n(0,s=c));const i=typeof BarcodeDetector<"u";return En.ask(),[s,i]}class Cs extends kt{constructor(t){super(),yt(this,t,Fs,Ss,Ve,{})}}const An="0.0.3",Ds=localStorage.getItem("version");An!==Ds&&(localStorage.setItem("version",An),alert("New version detected."));new Cs({target:document.getElementById("app")});
