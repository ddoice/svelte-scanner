var Ln=Object.defineProperty;var Bn=(e,t,n)=>t in e?Ln(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var at=(e,t,n)=>(Bn(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();function k(){}function Pn(e){return e()}function Sn(){return Object.create(null)}function oe(e){e.forEach(Pn)}function kn(e){return typeof e=="function"}function Ue(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let je;function U(e,t){return e===t?!0:(je||(je=document.createElement("a")),je.href=t,e===je.href)}function jn(e){return Object.keys(e).length===0}function zn(e,...t){if(e==null){for(const s of t)s(void 0);return k}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function mt(e,t,n){e.$$.on_destroy.push(zn(t,n))}function Fn(e){return e??""}function o(e,t){e.appendChild(t)}function O(e,t,n){e.insertBefore(t,n||null)}function T(e){e.parentNode&&e.parentNode.removeChild(e)}function qn(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function S(){return h(" ")}function Un(){return h("")}function R(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function d(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Rn(e){return e===""?null:+e}function Vn(e){return Array.from(e.childNodes)}function D(e,t){t=""+t,e.data!==t&&(e.data=t)}function Cn(e,t){e.value=t??""}let fe;function ae(e){fe=e}function Zn(){if(!fe)throw new Error("Function called outside component initialization");return fe}function Hn(e){Zn().$$.on_mount.push(e)}const ne=[],dt=[];let se=[];const Dn=[],Jn=Promise.resolve();let pt=!1;function Kn(){pt||(pt=!0,Jn.then(En))}function gt(e){se.push(e)}const ut=new Set;let ee=0;function En(){if(ee!==0)return;const e=fe;do{try{for(;ee<ne.length;){const t=ne[ee];ee++,ae(t),Wn(t.$$)}}catch(t){throw ne.length=0,ee=0,t}for(ae(null),ne.length=0,ee=0;dt.length;)dt.pop()();for(let t=0;t<se.length;t+=1){const n=se[t];ut.has(n)||(ut.add(n),n())}se.length=0}while(ne.length);for(;Dn.length;)Dn.pop()();pt=!1,ut.clear(),ae(e)}function Wn(e){if(e.fragment!==null){e.update(),oe(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(gt)}}function Xn(e){const t=[],n=[];se.forEach(s=>e.indexOf(s)===-1?t.push(s):n.push(s)),n.forEach(s=>s()),se=t}const ze=new Set;let X;function Yn(){X={r:0,c:[],p:X}}function Gn(){X.r||oe(X.c),X=X.p}function ue(e,t){e&&e.i&&(ze.delete(e),e.i(t))}function qe(e,t,n,s){if(e&&e.o){if(ze.has(e))return;ze.add(e),X.c.push(()=>{ze.delete(e),s&&(n&&e.d(1),s())}),e.o(t)}else s&&s()}function Mn(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function An(e){e&&e.c()}function vt(e,t,n){const{fragment:s,after_update:i}=e.$$;s&&s.m(t,n),gt(()=>{const c=e.$$.on_mount.map(Pn).filter(kn);e.$$.on_destroy?e.$$.on_destroy.push(...c):oe(c),e.$$.on_mount=[]}),i.forEach(gt)}function ht(e,t){const n=e.$$;n.fragment!==null&&(Xn(n.after_update),oe(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Qn(e,t){e.$$.dirty[0]===-1&&(ne.push(e),Kn(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function _t(e,t,n,s,i,c,l=null,u=[-1]){const m=fe;ae(e);const r=e.$$={fragment:null,ctx:[],props:c,update:k,not_equal:i,bound:Sn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:Sn(),dirty:u,skip_bound:!1,root:t.target||m.$$.root};l&&l(r.root);let C=!1;if(r.ctx=n?n(e,t.props||{},(a,y,...b)=>{const $=b.length?b[0]:y;return r.ctx&&i(r.ctx[a],r.ctx[a]=$)&&(!r.skip_bound&&r.bound[a]&&r.bound[a]($),C&&Qn(e,a)),y}):[],r.update(),C=!0,oe(r.before_update),r.fragment=s?s(r.ctx):!1,t.target){if(t.hydrate){const a=Vn(t.target);r.fragment&&r.fragment.l(a),a.forEach(T)}else r.fragment&&r.fragment.c();t.intro&&ue(e.$$.fragment),vt(e,t.target,t.anchor),En()}ae(m)}class bt{constructor(){at(this,"$$");at(this,"$$set")}$destroy(){ht(this,1),this.$destroy=k}$on(t,n){if(!kn(n))return k;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!jn(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const xn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(xn);const te=[];function wt(e,t=k){let n;const s=new Set;function i(u){if(Ue(e,u)&&(e=u,n)){const m=!te.length;for(const r of s)r[1](),te.push(r,e);if(m){for(let r=0;r<te.length;r+=2)te[r][0](te[r+1]);te.length=0}}}function c(u){i(u(e))}function l(u,m=k){const r=[u,m];return s.add(r),s.size===1&&(n=t(i,c)||k),u(e),()=>{s.delete(r),s.size===0&&n&&(n(),n=null)}}return{set:i,update:c,subscribe:l}}let Tn=0;const es=3e3;function ts(){const{subscribe:e,update:t}=wt([]);function n(i){Tn+=1;const c=Tn,l={...i,id:c};t(u=>[...u,l].slice(-5)),setTimeout(()=>{s(c)},es)}function s(i){t(c=>c.filter(l=>l.id!==i))}return{subscribe:e,addNotification:n,closeNotification:s}}const de=ts();function On(e,t,n){const s=e.slice();return s[2]=t[n],s}function In(e){let t,n,s=e[2].text+"",i,c,l,u,m,r,C;function a(){return e[1](e[2])}return{c(){t=f("div"),n=f("div"),i=h(s),c=S(),l=f("button"),l.textContent="X",u=S(),d(l,"class","svelte-1mipv5u"),d(t,"class",m=Fn(`notification ${e[2].type}`)+" svelte-1mipv5u")},m(y,b){O(y,t,b),o(t,n),o(n,i),o(t,c),o(t,l),o(t,u),r||(C=R(l,"click",a),r=!0)},p(y,b){e=y,b&1&&s!==(s=e[2].text+"")&&D(i,s),b&1&&m!==(m=Fn(`notification ${e[2].type}`)+" svelte-1mipv5u")&&d(t,"class",m)},d(y){y&&T(t),r=!1,C()}}}function ns(e){let t,n=Mn(e[0]),s=[];for(let i=0;i<n.length;i+=1)s[i]=In(On(e,n,i));return{c(){t=f("div");for(let i=0;i<s.length;i+=1)s[i].c();d(t,"id","notifications-container"),d(t,"class","svelte-1mipv5u")},m(i,c){O(i,t,c);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(t,null)},p(i,[c]){if(c&1){n=Mn(i[0]);let l;for(l=0;l<n.length;l+=1){const u=On(i,n,l);s[l]?s[l].p(u,c):(s[l]=In(u),s[l].c(),s[l].m(t,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=n.length}},i:k,o:k,d(i){i&&T(t),qn(s,i)}}}function ss(e,t,n){let s;return mt(e,de,c=>n(0,s=c)),[s,c=>de.closeNotification(c.id)]}class os extends bt{constructor(t){super(),_t(this,t,ss,ns,Ue,{})}}const is="https://yup.perfdive.com/api",yt=async(e,t)=>{const n=await fetch(`${is}${e}`,t);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return n},cs=async e=>{try{return await yt("/log",{method:"POST",headers:{"Content-Type":"application/json",device:localStorage.getItem("deviceAlias"),event:"trackCapabilities"},body:JSON.stringify(e)})}catch(t){console.error(t),de.addNotification({text:"sendTrackCapabilities failed, "+t.message,type:"error"})}},ls=async e=>{try{return await yt("/log",{method:"POST",headers:{"Content-Type":"application/json",device:localStorage.getItem("deviceAlias"),event:"trackSettings"},body:JSON.stringify(e)})}catch(t){console.error(t),de.addNotification({text:"sendTrackSettings failed, "+t.message,type:"error"})}},rs=async e=>{const t=new FormData;t.append("photo",e);try{const n=await yt("/upload",{method:"POST",body:t,headers:{device:localStorage.getItem("deviceAlias"),event:"trackSettings"}})}catch(n){console.error(n),de.addNotification({text:"sendPhoto failed, "+n.message,type:"error"})}},as=e=>{const t=e.getCapabilities(),n=e.getSettings();return cs(t),ls(n),{capabilities:t,canAutoFocus:()=>t.focusDistance&&t.focusMode&&(t==null?void 0:t.focusMode.includes("manual"))||!1,getFocusDistance:()=>{const{focusDistance:a}=t;return a&&(a.max-a.min)/a.step,a},getSettings:()=>e.getSettings(),setFocusMode:a=>e.applyConstraints({advanced:[{focusMode:a}]}),setFocusDistance:a=>e.applyConstraints({advanced:[{focusMode:"manual",focusDistance:a}]}),setTorch:a=>{t.torch&&e.applyConstraints({advanced:[{torch:a}]})},settings:n,setFocusDistancePct:async a=>{const{focusDistance:y}=t;if(!y){alert("Focus distance not supported");return}const b=(y.max-y.min)/100,$=y.min+b*a;try{await e.applyConstraints({advanced:[{focusMode:"manual",focusDistance:$}]})}catch(p){alert(p.message),console.error(p)}return $},setZoom:a=>e.applyConstraints({advanced:[{zoom:a}]})}};function us(){const e=["grabFrame","videoCapture"];let t="videoCapture",n=0,s=0,i=0,c=0,l=0,u,m=!1,r=null,C,a,y;function b(_,F,w,A){y=_,C=new ImageCapture(F),a=new BarcodeDetector({formats:["pdf417"]})}async function $(){if(t==="grabFrame")return C.grabFrame();if(t==="videoCapture")return y;if(t==="takePhoto"){const _=await C.takePhoto(),F=new Image;return F.src=URL.createObjectURL(_),await new Promise(w=>{F.onload=w}),F}}async function p(){const _=await $();return await a.detect(_)}async function M(){try{const _=await C.grabFrame(),F=document.createElement("canvas"),w=F.getContext("2d");F.width=_.width,F.height=_.height,w.drawImage(_,0,0),F.toBlob(A=>{rs(A)})}catch(_){console.log(_)}}function I(_){const F=Date.now()-_;c+=1,l=c>1?(l*(c-1)+F)/c:F,N(w=>({...w,scanCount:c,average:l}))}async function L(){try{const _=Date.now(),F=await p();if(m)return;I(_),F.length>0?(n+=1,r=F[0].rawValue,N(w=>({...w,barcode:r,success:n}))):(s+=1,N(w=>({...w,fail:s})))}catch(_){i+=1,N(F=>({...F,error:i})),console.log(_)}finally{setTimeout(L,100)}}function B(){m=!0,clearInterval(u)}const{subscribe:V,update:N}=wt({mode:t,success:n,fail:s,barcode:r,scanCount:c,error:i,average:l,toggleMode:()=>{const F=(e.indexOf(t)+1)%e.length;t=e[F],N(w=>({...w,mode:t}))},resetStats:()=>{n=0,s=0},resetBarcode:()=>{r=null}});return{init:b,subscribe:V,toggleMode:()=>N(_=>({..._,mode:e[(e.indexOf(_.mode)+1)%e.length]})),resetStats:()=>N(_=>({..._,success:0,fail:0,error:0,scanCount:0,average:0})),resetBarcode:()=>N(_=>({..._,barcode:null})),stop:B,start:()=>{m=!1,L(),u=setInterval(M,5e3)}}}function fs(e){var Jt,Kt,Wt,Xt,Yt,Gt,Qt,xt,en,tn,nn,sn,on,cn,ln;let t,n,s,i=e[1].scanCount+"",c,l,u,m,r=e[1].average.toFixed(2)+"",C,a,y,b,$=e[1].fail+"",p,M,I,L,B=e[1].success+"",V,N,_,F,w=((Jt=e[8])==null?void 0:Jt.exposureTime)+"",A,$t,pe,St,ge=((Kt=e[8])==null?void 0:Kt.contrast)+"",Re,Ft,me,Ct,ve=((Wt=e[8])==null?void 0:Wt.exposureMode)+"",Ve,Dt,he,Mt,_e=((Xt=e[8])==null?void 0:Xt.height)+"",Ze,Tt,be,Ot,we=((Yt=e[8])==null?void 0:Yt.width)+"",He,It,ye,Nt,$e=((Gt=e[8])==null?void 0:Gt.resizeMode)+"",Je,Pt,Se,kt,Fe=((Qt=e[8])==null?void 0:Qt.saturation)+"",Ke,Et,Ce,At,De=((xt=e[8])==null?void 0:xt.sharpness)+"",We,Xe,j,Ye,E,Y,ie,Z,Me,Lt,Ge,Bt,G,P,Te,jt,z,Qe,Oe=((nn=(tn=(en=e[0])==null?void 0:en.capabilities)==null?void 0:tn.focusDistance)==null?void 0:nn.min.toFixed(2))+"",xe,zt,et,Ie=(e[3]?e[3].toFixed(2):"-")+"",tt,qt,nt,Ne=((cn=(on=(sn=e[0])==null?void 0:sn.capabilities)==null?void 0:on.focusDistance)==null?void 0:cn.max.toFixed(2))+"",st,Ut,Q,ce,H,Pe,Rt,ot,it,q,ke,J,K,Ee,Ae,Vt,ct,x,Le=((ln=e[1])==null?void 0:ln.mode)+"",lt,Zt,le,W,Be,rt,Ht;return{c(){var g;t=f("div"),n=f("div"),s=h("Scan count: "),c=h(i),l=S(),u=f("div"),m=h("Average: "),C=h(r),a=S(),y=f("div"),b=h("Fail: "),p=h($),M=S(),I=f("div"),L=h("Success: "),V=h(B),N=S(),_=f("div"),F=h("exposureTime: "),A=h(w),$t=S(),pe=f("div"),St=h("Contrast "),Re=h(ge),Ft=S(),me=f("div"),Ct=h("exposureMode: "),Ve=h(ve),Dt=S(),he=f("div"),Mt=h("height: "),Ze=h(_e),Tt=S(),be=f("div"),Ot=h("width: "),He=h(we),It=S(),ye=f("div"),Nt=h("resizeMode: "),Je=h($e),Pt=S(),Se=f("div"),kt=h("saturation: "),Ke=h(Fe),Et=S(),Ce=f("div"),At=h("sharpness: "),We=h(De),Xe=S(),j=f("video"),j.innerHTML="",Ye=S(),E=f("div"),Y=f("div"),ie=f("button"),Z=f("img"),Lt=S(),Ge=h(e[7]),Bt=S(),G=f("div"),P=f("input"),jt=S(),z=f("div"),Qe=f("span"),xe=h(Oe),zt=S(),et=f("span"),tt=h(Ie),qt=S(),nt=f("span"),st=h(Ne),Ut=S(),Q=f("div"),ce=f("button"),H=f("img"),Rt=S(),ot=h(e[4]),it=S(),q=f("div"),ke=f("div"),J=f("button"),K=f("img"),Vt=S(),ct=f("div"),x=f("div"),lt=h(Le),Zt=S(),le=f("button"),W=f("img"),d(t,"class","stats svelte-c2s76a"),j.autoplay=!0,d(j,"id","stream"),d(j,"class","svelte-c2s76a"),U(Z.src,Me=`public/${e[7]}-focus.svg`)||d(Z,"src",Me),d(Z,"class","svelte-c2s76a"),d(ie,"class","svelte-c2s76a"),d(Y,"class","focus__group svelte-c2s76a"),P.disabled=Te=e[7]==="continuous",d(P,"id","zoom__range"),d(P,"type","range"),d(P,"min","0"),d(P,"max","100"),d(P,"class","svelte-c2s76a"),d(z,"class","focus__range svelte-c2s76a"),d(G,"class","focus__group grow svelte-c2s76a"),U(H.src,Pe=`public/${e[4]}-facingMode.svg`)||d(H,"src",Pe),d(H,"class","svelte-c2s76a"),d(ce,"class","svelte-c2s76a"),d(Q,"class","focus__group svelte-c2s76a"),d(E,"id","focus"),d(E,"class","svelte-c2s76a"),U(K.src,Ee=`public/torch-${e[5]?"on":"off"}.svg`)||d(K,"src",Ee),d(K,"class","svelte-c2s76a"),J.disabled=Ae=!e[0]||!e[0].capabilities.torch,d(J,"class","svelte-c2s76a"),d(ke,"class","focus__group svelte-c2s76a"),U(W.src,Be=`public/mode-${(g=e[1])==null?void 0:g.mode}.svg`)||d(W,"src",Be),d(W,"class","svelte-c2s76a"),d(le,"class","svelte-c2s76a"),d(x,"class","focus__group svelte-c2s76a"),d(q,"id","toggles"),d(q,"class","svelte-c2s76a")},m(g,v){var re;O(g,t,v),o(t,n),o(n,s),o(n,c),o(t,l),o(t,u),o(u,m),o(u,C),o(t,a),o(t,y),o(y,b),o(y,p),o(t,M),o(t,I),o(I,L),o(I,V),o(t,N),o(t,_),o(_,F),o(_,A),o(t,$t),o(t,pe),o(pe,St),o(pe,Re),o(t,Ft),o(t,me),o(me,Ct),o(me,Ve),o(t,Dt),o(t,he),o(he,Mt),o(he,Ze),o(t,Tt),o(t,be),o(be,Ot),o(be,He),o(t,It),o(t,ye),o(ye,Nt),o(ye,Je),o(t,Pt),o(t,Se),o(Se,kt),o(Se,Ke),o(t,Et),o(t,Ce),o(Ce,At),o(Ce,We),O(g,Xe,v),O(g,j,v),e[14](j),O(g,Ye,v),O(g,E,v),o(E,Y),o(Y,ie),o(ie,Z),o(Y,Lt),o(Y,Ge),o(E,Bt),o(E,G),o(G,P),Cn(P,e[2]),o(G,jt),o(G,z),o(z,Qe),o(Qe,xe),o(z,zt),o(z,et),o(et,tt),o(z,qt),o(z,nt),o(nt,st),o(E,Ut),o(E,Q),o(Q,ce),o(ce,H),o(Q,Rt),o(Q,ot),O(g,it,v),O(g,q,v),o(q,ke),o(ke,J),o(J,K),o(q,Vt),o(q,ct),o(ct,x),o(x,lt),o(x,Zt),o(x,le),o(le,W),rt||(Ht=[R(ie,"click",e[12]),R(P,"change",e[15]),R(P,"input",e[15]),R(P,"change",e[9]),R(ce,"click",e[13]),R(J,"click",e[10]),R(le,"click",(re=e[11])==null?void 0:re.toggleMode)],rt=!0)},p(g,[v]){var re,rn,an,un,fn,dn,pn,gn,mn,vn,hn,_n,bn,wn,yn,$n;v&2&&i!==(i=g[1].scanCount+"")&&D(c,i),v&2&&r!==(r=g[1].average.toFixed(2)+"")&&D(C,r),v&2&&$!==($=g[1].fail+"")&&D(p,$),v&2&&B!==(B=g[1].success+"")&&D(V,B),v&256&&w!==(w=((re=g[8])==null?void 0:re.exposureTime)+"")&&D(A,w),v&256&&ge!==(ge=((rn=g[8])==null?void 0:rn.contrast)+"")&&D(Re,ge),v&256&&ve!==(ve=((an=g[8])==null?void 0:an.exposureMode)+"")&&D(Ve,ve),v&256&&_e!==(_e=((un=g[8])==null?void 0:un.height)+"")&&D(Ze,_e),v&256&&we!==(we=((fn=g[8])==null?void 0:fn.width)+"")&&D(He,we),v&256&&$e!==($e=((dn=g[8])==null?void 0:dn.resizeMode)+"")&&D(Je,$e),v&256&&Fe!==(Fe=((pn=g[8])==null?void 0:pn.saturation)+"")&&D(Ke,Fe),v&256&&De!==(De=((gn=g[8])==null?void 0:gn.sharpness)+"")&&D(We,De),v&128&&!U(Z.src,Me=`public/${g[7]}-focus.svg`)&&d(Z,"src",Me),v&128&&D(Ge,g[7]),v&128&&Te!==(Te=g[7]==="continuous")&&(P.disabled=Te),v&4&&Cn(P,g[2]),v&1&&Oe!==(Oe=((hn=(vn=(mn=g[0])==null?void 0:mn.capabilities)==null?void 0:vn.focusDistance)==null?void 0:hn.min.toFixed(2))+"")&&D(xe,Oe),v&8&&Ie!==(Ie=(g[3]?g[3].toFixed(2):"-")+"")&&D(tt,Ie),v&1&&Ne!==(Ne=((wn=(bn=(_n=g[0])==null?void 0:_n.capabilities)==null?void 0:bn.focusDistance)==null?void 0:wn.max.toFixed(2))+"")&&D(st,Ne),v&16&&!U(H.src,Pe=`public/${g[4]}-facingMode.svg`)&&d(H,"src",Pe),v&16&&D(ot,g[4]),v&32&&!U(K.src,Ee=`public/torch-${g[5]?"on":"off"}.svg`)&&d(K,"src",Ee),v&1&&Ae!==(Ae=!g[0]||!g[0].capabilities.torch)&&(J.disabled=Ae),v&2&&Le!==(Le=((yn=g[1])==null?void 0:yn.mode)+"")&&D(lt,Le),v&2&&!U(W.src,Be=`public/mode-${($n=g[1])==null?void 0:$n.mode}.svg`)&&d(W,"src",Be)},i:k,o:k,d(g){g&&(T(t),T(Xe),T(j),T(Ye),T(E),T(it),T(q)),e[14](null),rt=!1,oe(Ht)}}}function ds(e,t,n){let s,i=0,c,l="environment",u=!1;async function m(w){console.log(w.target.value),n(2,i=w.target.value);const A=await($==null?void 0:$.setFocusDistancePct(i));n(3,c=A||void 0)}async function r(){n(5,u=!u),await($==null?void 0:$.setTorch(u))}const C=()=>navigator.mediaDevices.getUserMedia({video:{facingMode:l,width:{ideal:1080}},audio:!1});let a,y,b,$,p=us();mt(e,p,w=>n(1,s=w));const M=["continuous","manual"];let I="continuous";const L=async()=>{try{b==null||b.stop(),p==null||p.stop(),y=await C(),n(6,a.srcObject=y,a),b=y.getVideoTracks()[0],n(0,$=as(b)),p.init(a,b,a.width,a.height),p.start()}catch(w){console.log("error",w),alert("Could not access the camera")}},B=async()=>{const w=M[M.indexOf(I)+1]||M[0];try{await $.setFocusMode(I),n(7,I=w)}catch{alert("Could not set focus mode")}},V=async()=>{n(4,l=l==="environment"?"user":"environment"),await L()};Hn(()=>((async()=>await L())(),()=>p==null?void 0:p.stop()));let N;function _(w){dt[w?"unshift":"push"](()=>{a=w,n(6,a)})}function F(){i=Rn(this.value),n(2,i)}return e.$$.update=()=>{e.$$.dirty&3&&(s==null||s.scanCount,n(8,N=$==null?void 0:$.getSettings()))},[$,s,i,c,l,u,a,I,N,m,r,p,B,V,_,F]}class ps extends bt{constructor(t){super(),_t(this,t,ds,fs,Ue,{})}}const ft="deviceAlias",gs=()=>{const{subscribe:e,set:t}=wt(localStorage.getItem(ft));return{subscribe:e,ask:()=>{if(localStorage.getItem(ft))return;let n=prompt("Please input your device alias","device");n?(localStorage.setItem(ft,n),t(n)):alert("You must provide a device alias")}}},Nn=gs();function ms(e){let t;return{c(){t=f("h1"),t.textContent="BarcodeDetector not supported."},m(n,s){O(n,t,s)},d(n){n&&T(t)}}}function vs(e){let t;return{c(){t=f("h1"),t.textContent="Waiting for device alias..."},m(n,s){O(n,t,s)},i:k,o:k,d(n){n&&T(t)}}}function hs(e){let t,n;return t=new ps({}),{c(){An(t.$$.fragment)},m(s,i){vt(t,s,i),n=!0},i(s){n||(ue(t.$$.fragment,s),n=!0)},o(s){qe(t.$$.fragment,s),n=!1},d(s){ht(t,s)}}}function _s(e){let t,n,s,i,c,l,u,m,r,C;s=new os({});let a=!e[1]&&ms();const y=[hs,vs],b=[];function $(p,M){return p[0]?0:1}return u=$(e),m=b[u]=y[u](e),{c(){t=f("meta"),n=S(),An(s.$$.fragment),i=S(),c=f("main"),a&&a.c(),l=S(),m.c(),r=Un(),d(t,"name","viewport"),d(t,"content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")},m(p,M){o(document.head,t),O(p,n,M),vt(s,p,M),O(p,i,M),O(p,c,M),a&&a.m(c,null),O(p,l,M),b[u].m(p,M),O(p,r,M),C=!0},p(p,[M]){let I=u;u=$(p),u!==I&&(Yn(),qe(b[I],1,1,()=>{b[I]=null}),Gn(),m=b[u],m||(m=b[u]=y[u](p),m.c()),ue(m,1),m.m(r.parentNode,r))},i(p){C||(ue(s.$$.fragment,p),ue(m),C=!0)},o(p){qe(s.$$.fragment,p),qe(m),C=!1},d(p){p&&(T(n),T(i),T(c),T(l),T(r)),T(t),ht(s,p),a&&a.d(),b[u].d(p)}}}function bs(e,t,n){let s;mt(e,Nn,c=>n(0,s=c));const i=typeof BarcodeDetector<"u";return Nn.ask(),[s,i]}class ws extends bt{constructor(t){super(),_t(this,t,bs,_s,Ue,{})}}new ws({target:document.getElementById("app")});
